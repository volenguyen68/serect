{"version":3,"sources":["jave.js"],"names":["console","clear","scene","THREE","Scene","camera","PerspectiveCamera","window","innerWidth","innerHeight","renderer","WebGLRenderer","antialias","setClearColor","setSize","document","body","appendChild","domElement","position","z","controls","TrackballControls","noPan","maxDistance","minDistance","group","Group","add","heart","sampler","originHeart","OBJLoader","load","obj","children","geometry","rotateX","Math","PI","scale","translate","material","MeshBasicMaterial","color","Array","from","attributes","array","MeshSurfaceSampler","build","init","setAnimationLoop","render","positions","BufferGeometry","LineBasicMaterial","lines","LineSegments","simplex","SimplexNoise","pos","Vector3","Grass","sample","clone","random","one","two","a","noise","noise4D","x","y","multiplyScalar","beat","setLength","spikes","i","g","push","gsap","timeline","repeat","repeatDelay","to","duration","ease","rotation","forEach","update","setAttribute","BufferAttribute","Float32Array","vs","length","v","needsUpdate","addEventListener","onWindowResize","aspect","updateProjectionMatrix"],"mappings":"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","sourcesContent":["console.clear();\n\nconst scene = new THREE.Scene();\nconst camera = new THREE.PerspectiveCamera(\n  75,\n  window.innerWidth / window.innerHeight,\n  0.1,\n  1000\n);\n\nconst renderer = new THREE.WebGLRenderer({\n  antialias: true\n});\nrenderer.setClearColor(0xff5555);\nrenderer.setSize(window.innerWidth, window.innerHeight);\ndocument.body.appendChild(renderer.domElement);\n\ncamera.position.z = 1;\n\nconst controls = new THREE.TrackballControls(camera, renderer.domElement);\ncontrols.noPan = true;\ncontrols.maxDistance = 3;\ncontrols.minDistance = 0.7;\n\nconst group = new THREE.Group();\nscene.add(group);\n\nlet heart = null;\nlet sampler = null;\nlet originHeart = null;\nnew THREE.OBJLoader().load('https://assets.codepen.io/127738/heart_2.obj',obj => {\n  heart = obj.children[0];\n  heart.geometry.rotateX(-Math.PI * 0.5);\n  heart.geometry.scale(0.04, 0.04, 0.04);\n  heart.geometry.translate(0, -0.4, 0);\n  group.add(heart);\n  \n  heart.material = new THREE.MeshBasicMaterial({\n    color: 0xff5555    \n  });\n  originHeart = Array.from(heart.geometry.attributes.position.array);\n  sampler = new THREE.MeshSurfaceSampler(heart).build();\n  init();\n  renderer.setAnimationLoop(render);\n});\n\nlet positions = [];\nconst geometry = new THREE.BufferGeometry();\nconst material = new THREE.LineBasicMaterial({\n  color: 0xffffff\n});\nconst lines = new THREE.LineSegments(geometry, material);\ngroup.add(lines);\n\nconst simplex = new SimplexNoise();\nconst pos = new THREE.Vector3();\nclass Grass {\n  constructor () {\n    sampler.sample(pos);\n    this.pos = pos.clone();\n    this.scale = Math.random() * 0.01 + 0.001;\n    this.one = null;\n    this.two = null;\n  }\n  update (a) {\n    const noise = simplex.noise4D(this.pos.x*1.5, this.pos.y*1.5, this.pos.z*1.5, a * 0.0005) + 1;\n    this.one = this.pos.clone().multiplyScalar(1.01 + (noise * 0.15 * beat.a));\n    this.two = this.one.clone().add(this.one.clone().setLength(this.scale));\n  }\n}\n\nlet spikes = [];\nfunction init (a) {\n  positions = [];\n  for (let i = 0; i < 20000; i++) {\n    const g = new Grass();\n    spikes.push(g);\n  }\n}\n\nconst beat = { a: 0 };\ngsap.timeline({\n  repeat: -1,\n  repeatDelay: 0.3\n}).to(beat, {\n  a: 1.2,\n  duration: 0.6,\n  ease: 'power2.in'\n}).to(beat, {\n  a: 0.0,\n  duration: 0.6,\n  ease: 'power3.out'\n});\ngsap.to(group.rotation, {\n  y: Math.PI * 2,\n  duration: 12,\n  ease: 'none',\n  repeat: -1\n});\n\nfunction render(a) {\n  positions = [];\n  spikes.forEach(g => {\n    g.update(a);\n    positions.push(g.one.x, g.one.y, g.one.z);\n    positions.push(g.two.x, g.two.y, g.two.z);\n  });\n  geometry.setAttribute('position', new THREE.BufferAttribute(new Float32Array(positions), 3));\n  \n  const vs = heart.geometry.attributes.position.array;\n  for (let i = 0; i < vs.length; i+=3) {\n    const v = new THREE.Vector3(originHeart[i], originHeart[i+1], originHeart[i+2]);\n    const noise = simplex.noise4D(originHeart[i]*1.5, originHeart[i+1]*1.5, originHeart[i+2]*1.5, a * 0.0005) + 1;\n    v.multiplyScalar(1 + (noise * 0.15 * beat.a));\n    vs[i] = v.x;\n    vs[i+1] = v.y;\n    vs[i+2] = v.z;\n  }\n  heart.geometry.attributes.position.needsUpdate = true;\n  \n  controls.update();\n  renderer.render(scene, camera);\n}\n\nwindow.addEventListener(\"resize\", onWindowResize, false);\nfunction onWindowResize() {\n  camera.aspect = window.innerWidth / window.innerHeight;\n  camera.updateProjectionMatrix();\n  renderer.setSize(window.innerWidth, window.innerHeight);\n}\n"],"file":"jave.dev.js"}